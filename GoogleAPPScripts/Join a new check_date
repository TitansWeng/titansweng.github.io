{"files":[{"id":"45f201e0-0f32-44cf-b914-8ebc917f1cd3","name":"程式碼","type":"server_js","source":"function doGet(e) {\n  var params \u003d e.parameter;\n  var today \u003d params.today;\n  \n  //將Sheet指定為\"資料表\"試算表  SpreadSheet \u003d  試算表\n  var SpreadSheet \u003d SpreadsheetApp.openById(\"1VbJanValnNIHfZ9ujsFNUIw9XJCYglFdCBa7mtexUUs\");\n  //取得頁簽:\"簽到狀況\"\n  var Sheet \u003d SpreadSheet.getSheetByName(\"簽到狀況\");\n  var Sheet_time \u003d SpreadSheet.getSheetByName(\"簽到時間\");\n  //取得所有資料的最後一行\"行數\"\n  var LastRaw \u003d Sheet.getLastRow();\n  var LastCol \u003d Sheet.getLastColumn();\n  \n  check_dates \u003d Sheet.getRange(1,1,1,LastCol).getValues();\n  for(i\u003d0;i\u003cLastCol;i++){\n    if(today \u003d\u003d check_dates[0][i]){\n      return ContentService.createTextOutput(\"1\" + \u0027,\u0027 + \"新增簽到日期失敗(已有此簽到日期 ( \"+ today + \" )\")\n    }\n  }\n  \n  //加入新的簽到日期到新的Col\n  Sheet.getRange(1,LastCol+1).setValue(\u0027*\u0027 + today);\n  Sheet.getRange(1,LastCol+1).setHorizontalAlignment(\"center\");\n  \n  \n  Sheet_time.getRange(1,LastCol+1).setValue(\u0027*\u0027 + today);\n  Sheet_time.getRange(1,LastCol+1).setHorizontalAlignment(\"center\");\n  \n  //將每個欄位預設為 未報到  \n  for(index\u003d2;index\u003c\u003dLastRaw;index++){\n    Sheet.getRange(index,LastCol+1).setValue(\u0027未報到\u0027);\n    Sheet.getRange(index,LastCol+1).setBackground(\u0027red\u0027);\n    Sheet.getRange(index,LastCol+1).setHorizontalAlignment(\"center\");\n    \n    Sheet_time.getRange(index,LastCol+1).setValue(\u0027未報到\u0027);\n    Sheet_time.getRange(index,LastCol+1).setBackground(\u0027red\u0027);\n    Sheet_time.getRange(index,LastCol+1).setHorizontalAlignment(\"center\");\n  }\n  return ContentService.createTextOutput(\"0\" + \u0027,\u0027 + \"新增簽到日期成功( \"+ today + \" )\");\n}\n"},{"id":"81f07dca-beb8-4dbb-a312-a7a882a7ccd2","name":"Debug","type":"server_js","source":"function myFunction() {\n  doGet(\n    {parameter:\n     {\n       today: \"*2016/09/06\"\n     }\n    }\n  );\n}"}]}
